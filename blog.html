<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI/ML voor Rocket League - Blog</title>
    <!-- Favicons voor verschillende apparaten en browsers -->
    <link rel="icon" href="images/favicon/favicon.ico" sizes="any">
    <link rel="icon" type="image/svg+xml" href="images/favicon/favicon.svg">
    <link rel="apple-touch-icon" href="images/favicon/apple-touch-icon.png">
    <link rel="manifest" href="images/favicon/site.webmanifest">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="blog-styles.css">
    <link rel="stylesheet" href="blog-icon-fix.css">
    <link rel="stylesheet" href="blog-loader.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script type="module" src="firebase-blog.js"></script>
    <!-- Firebase debug and fix script -->
    <script type="module" src="firebase-debug.js"></script>
    <!-- Admin login script -->
    <script src="admin-login.js" defer></script>
</head>
<body>
    <div class="theme-switch">
        <input type="checkbox" id="theme-toggle">
        <label for="theme-toggle" class="switch">
            <i class="fas fa-sun"></i>
            <i class="fas fa-moon"></i>
        </label>
    </div>
    
    <!-- Admin button (hidden by default) -->
    <div class="admin-access">
        <button id="admin-button"><i class="fas fa-lock"></i></button>
    </div>
    
    <!-- Admin panel (hidden by default) -->
    <div id="admin-panel" class="hidden">
        <div class="admin-panel-content">
            <h3>Admin Panel</h3>
            <div id="password-form">
                <input type="password" id="admin-password" placeholder="Password...">
                <button id="password-submit">Login</button>
            </div>
            
            <div id="day-creator" class="hidden">
                <div class="admin-tabs">
                    <button class="tab-btn active" data-tab="create-tab">Create New Day</button>
                    <button class="tab-btn" data-tab="manage-tab">Manage Days</button>
                </div>
                
                <!-- Create tab -->
                <div id="create-tab" class="tab-content active">
                    <form id="new-day-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="day-number">Day Number:</label>
                                <input type="number" id="day-number" required placeholder="E.g. 1, 2, 3...">
                            </div>
                            
                            <div class="form-group">
                                <label for="day-label">Short Label:</label>
                                <input type="text" id="day-label" required maxlength="20" placeholder="E.g. Setup, Training Models...">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="day-date">Date:</label>
                                <input type="text" id="day-date" required placeholder="E.g. 27 Mei 2025">
                            </div>
                            
                            <div class="form-group">
                                <label for="day-category">Category:</label>
                                <input type="text" id="day-category" required placeholder="E.g. Data Processing, Model Training...">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="day-title">Full Title:</label>
                            <input type="text" id="day-title" required placeholder="E.g. Getting Started with Reinforcement Learning for Rocket League">
                        </div>
                        
                        <div class="form-group">
                            <label for="day-content">Content (HTML allowed):</label>
                            <textarea id="day-content" rows="10" required placeholder="Enter your blog content here. You can use HTML tags for formatting. E.g. &lt;p&gt;Today I started exploring the Rocket League API...&lt;/p&gt;"></textarea>
                        </div>
                        
                        <div class="preview-toggle">
                            <button type="button" id="preview-btn">Preview Post</button>
                        </div>
                        
                        <div id="post-preview" class="hidden">
                            <h4>Preview</h4>
                            <div class="preview-container">
                                <div class="preview-card">
                                    <span class="preview-day">Day <span id="preview-day-number"></span></span>
                                    <span class="preview-label" id="preview-label"></span>
                                </div>
                                
                                <div class="preview-content">
                                    <div class="preview-meta">
                                        <span id="preview-date"></span>
                                        <span id="preview-category"></span>
                                    </div>
                                    <h3 id="preview-title"></h3>
                                    <div id="preview-body"></div>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" id="create-day-btn">Create New Day</button>
                    </form>
                </div>
                
                <!-- Manage tab -->
                <div id="manage-tab" class="tab-content">
                    <h4>Manage Existing Days</h4>
                    <div class="manage-actions">
                        <button id="clear-all-days" class="danger-button"><i class="fas fa-trash-alt"></i> Verwijder Alle Dagen</button>
                    </div>
                    <div id="days-list-container">
                        <p class="no-days-message hidden">No days have been created yet.</p>
                        <div id="days-list"></div>
                    </div>
                </div>
                
                <div class="admin-footer">
                    <button id="close-admin-panel">Close Panel</button>
                </div>
            </div>
        </div>
    </div>

    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="back-link"><i class="fas fa-arrow-left"></i> Terug</a>
            <a href="index.html" class="logo">OS.</a>
        </div>
    </nav>



    <section id="blog-overview" class="section">
        <div class="container fade-in">
            <div class="blog-intro">
                <div class="section-header animate">
                    <h1>AI/ML voor Rocket League</h1>
                    <p class="section-subtitle">Een reis door machine learning en reinforcement learning toegepast op Rocket League</p>
                </div>

                <div class="blog-description animate animate-delay-1">
                    <h3 class="description-subtitle"><i class="fas fa-robot"></i> AI Training Journey</h3>
                    <p>Dit blog documenteert mijn ambitieuze experiment om een <strong>geavanceerde AI-agent</strong> te ontwikkelen die Rocket League kan spelen. Door gebruik te maken van state-of-the-art <strong>reinforcement learning</strong> technieken, train ik een neuraal netwerk dat leert van elke actie en reactie in het spel.</p>
                    
    
                    
                    <div class="highlight-points">
                        <div class="highlight-point">
                            <i class="fas fa-flask"></i>
                            <span>Experimenteren met verschillende netwerk-architecturen</span>
                        </div>
                        <div class="highlight-point">
                            <i class="fas fa-code"></i>
                            <span>Python implementaties van deep learning modellen</span>
                        </div>
                        <div class="highlight-point">
                            <i class="fas fa-chart-line"></i>
                            <span>Analyse van trainingsresultaten en prestaties</span>
                        </div>
                    </div>
                    

                </div>
            </div>

            <div class="project-calendar animate animate-delay-2">
                <h3 class="calendar-title">Dagelijkse Updates</h3>
                <p class="calendar-subtitle">Klik op een dag om de voortgang en ontdekkingen te bekijken</p>
                
                <div class="calendar-grid" id="calendar-grid">
                <!-- Calendar days will be dynamically created by the user through the admin panel -->
                </div>
            
                <!-- Empty state that shows when no days exist -->
                <div class="empty-state" id="empty-calendar-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-calendar-plus"></i>
                    </div>
                    <h3 class="empty-state-title">Nog geen blogdagen</h3>
                    <p class="empty-state-message">Gebruik het admin-panel om je eerste blogdag toe te voegen.</p>
                    <button id="empty-state-admin-button" class="empty-state-button">
                        <i class="fas fa-lock"></i> Admin Panel Openen
                    </button>
                </div>
            </div>
            
            <div class="blog-content-wrapper hidden">
                <!-- Back button - will be shown when viewing content -->
                <div class="back-to-calendar">
                    <button id="back-button" class="primary-button">
                        <i class="fas fa-arrow-left"></i> Terug naar Kalender
                    </button>
                </div>
                
                <!-- Blog posts will be dynamically created by the user through the admin panel -->
                <div class="blog-post-content animate">
                    <!-- Content will be inserted here dynamically -->
                </div>
            </div> <!-- end of blog-content-wrapper -->
            
            <div class="blog-sidebar-wrapper animate animate-delay-3">
                <aside class="blog-sidebar" id="blog-sidebar">
                <div class="sidebar-section recent-posts">
                    <h3>Recent Posts</h3>
                    <ul id="recent-posts-list">
                        <!-- Will be populated dynamically -->
                        <li class="no-posts-message">No posts available yet.</li>
                    </ul>
                </div>
            </aside>
            </div>
        </div>
    </section>
    
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Owen Samson. Alle rechten voorbehouden.</p>
        </div>
    </footer>

    <button id="back-to-top" class="back-to-top" aria-label="Terug naar boven">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script src="script.js"></script>
    <!-- Custom JavaScript for the blog page -->
    <script>
        // Back to Top Button Functionality
        const blogBackToTopBtn = document.getElementById('back-to-top');
        
        // Show button when user scrolls down 300px
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                blogBackToTopBtn.classList.add('visible');
            } else {
                blogBackToTopBtn.classList.remove('visible');
            }
        });
        
        // Scroll to top when button is clicked
        blogBackToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        document.addEventListener('DOMContentLoaded', function() {
            // Theme toggle functionality
            const themeToggle = document.getElementById('theme-toggle');
            const savedTheme = localStorage.getItem('theme');
            
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                if (savedTheme === 'dark') {
                    themeToggle.checked = true;
                }
            }
            
            themeToggle.addEventListener('change', function() {
                if (this.checked) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                    localStorage.setItem('theme', 'light');
                }
            });
            
            // Calendar days functionality
            const calendarDays = document.querySelectorAll('.calendar-day');
            const projectCalendar = document.querySelector('.project-calendar');
            const contentWrapper = document.querySelector('.blog-content-wrapper');
            const dayContents = document.querySelectorAll('.day-content');
            const backToCalendar = document.querySelector('.back-to-calendar');
            const blogSidebar = document.getElementById('blog-sidebar');
            
            // Function to show day content
            function showDayContent(day) {
                // Hide calendar, show content
                projectCalendar.classList.add('hidden');
                contentWrapper.classList.remove('hidden');
                backToCalendar.classList.remove('hidden');
                blogSidebar.classList.remove('hidden');
                
                // Show the specific day content
                dayContents.forEach(content => {
                    content.style.display = 'none';
                });
                document.getElementById(`day-${day}-content`).style.display = 'block';
                
                // Scroll to top
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            // Add click event to each calendar day
            calendarDays.forEach(day => {
                day.addEventListener('click', () => {
                    const dayNumber = day.getAttribute('data-day');
                    showDayContent(dayNumber);
                });
            });
            
            // Back to calendar button
            document.getElementById('back-button').addEventListener('click', function(e) {
                e.preventDefault(); // Prevent default behavior
                
                // Show calendar, hide content
                projectCalendar.classList.remove('hidden');
                contentWrapper.classList.add('hidden');
                blogSidebar.classList.add('hidden');
                
                // Scroll to top of calendar with a small offset for navigation
                window.scrollTo({
                    top: document.querySelector('.blog-header').offsetTop,
                    behavior: 'smooth'
                });
                
                return false; // Prevent event bubbling
            });
            
            // Mobile menu code removed - no longer needed for simplified navigation
            
            // Admin panel functionality - initialize properly
            const adminButton = document.getElementById('admin-button');
            const adminPanel = document.getElementById('admin-panel');
            
            // Add event listener to the main admin button - with direct DOM access
            if (adminButton) {
                adminButton.addEventListener('click', function() {
                    // Access elements directly by DOM ID to avoid scope issues
                    const panel = document.getElementById('admin-panel');
                    const passwordForm = document.getElementById('password-form');
                    const dayCreator = document.getElementById('day-creator');
                    const adminPasswordField = document.getElementById('admin-password');
                    
                    if (panel) panel.classList.remove('hidden');
                    if (passwordForm) passwordForm.classList.remove('hidden');
                    if (dayCreator) dayCreator.classList.add('hidden');
                    if (adminPasswordField) adminPasswordField.focus();
                });
            }
            
            // Only proceed with admin functionality if the panel exists
            if (adminButton && adminPanel) {
                const passwordForm = document.getElementById('password-form');
                const passwordSubmit = document.getElementById('password-submit');
                const adminPassword = document.getElementById('admin-password');
                const dayCreator = document.getElementById('day-creator');
                const closeAdminPanel = document.getElementById('close-admin-panel');
                const newDayForm = document.getElementById('new-day-form');
                const tabButtons = document.querySelectorAll('.tab-btn');
                const tabContents = document.querySelectorAll('.tab-content');
                const previewButton = document.getElementById('preview-btn');
                const postPreview = document.getElementById('post-preview');
                const daysList = document.getElementById('days-list');
                const noDaysMessage = document.querySelector('.no-days-message');
                
                // Password hash for admin access - this is a SHA-256 hash of the password
                // Default hash is for password "12345" - replace this with your own password hash
                const correctPasswordHash = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08";
                
                // Function to automatically set the next day number
                async function setNextDayNumber() {
                    try {
                        // Import Firebase functions
                        const { loadBlogsFromFirebase } = await import('./firebase-blog.js');
                        
                        // Get saved days from Firebase
                        const days = await loadBlogsFromFirebase();
                        let nextDayNumber = 1;
                        
                        if (Object.keys(days).length > 0) {
                            // Find the maximum day number and add 1
                            const dayNumbers = Object.keys(days).map(day => parseInt(day));
                            nextDayNumber = Math.max(...dayNumbers) + 1;
                        }
                        
                        // Set the value in the form
                        document.getElementById('day-number').value = nextDayNumber;
                        
                        // Also set today's date as default
                        const today = new Date();
                        const months = ['Januari', 'Februari', 'Maart', 'April', 'Mei', 'Juni', 'Juli', 'Augustus', 'September', 'Oktober', 'November', 'December'];
                        const dateString = `${today.getDate()} ${months[today.getMonth()]} ${today.getFullYear()}`;
                        document.getElementById('day-date').value = dateString;
                    } catch (error) {
                        console.error('Error setting next day number:', error);
                    }
                }
                
                // Tab switching functionality
                tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Update active button
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Show selected tab content
                    tabContents.forEach(tab => tab.classList.remove('active'));
                    document.getElementById(tabId).classList.add('active');
                    
                    // If switching to create tab, set next day number
                    if (tabId === 'create-tab') {
                        setNextDayNumber();
                    }
                    // If switching to manage tab, refresh the days list
                    else if (tabId === 'manage-tab') {
                        renderDaysList();
                    }
                });
            });
            
            // Preview functionality
            previewButton.addEventListener('click', function() {
                // Get form values
                const dayNumber = document.getElementById('day-number').value || '#';
                const dayLabel = document.getElementById('day-label').value || 'Label';
                const dayDate = document.getElementById('day-date').value || 'Date';
                const dayCategory = document.getElementById('day-category').value || 'Category';
                const dayTitle = document.getElementById('day-title').value || 'Title';
                const dayContent = document.getElementById('day-content').value || '<p>Content will appear here</p>';
                
                // Update preview elements
                document.getElementById('preview-day-number').textContent = dayNumber;
                document.getElementById('preview-label').textContent = dayLabel;
                document.getElementById('preview-date').textContent = dayDate;
                document.getElementById('preview-category').textContent = dayCategory;
                document.getElementById('preview-title').textContent = dayTitle;
                document.getElementById('preview-body').innerHTML = dayContent;
                
                // Show preview
                postPreview.classList.remove('hidden');
                
                // Scroll to preview
                postPreview.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
            
            // The Firebase version of showDayContent function
            async function showDayContent(dayNumber) {
                try {
                    // Import Firebase functions
                    const { loadBlogsFromFirebase } = await import('./firebase-blog.js');
                    
                    // Get saved days from Firebase
                    const days = await loadBlogsFromFirebase();
                    
                    // Check if the day exists
                    if (!days[dayNumber]) {
                        alert('Day not found!');
                        return;
                    }
                    
                    const day = days[dayNumber];
                    
                    // Hide calendar and show blog content section
                    document.querySelector('.project-calendar').classList.add('hidden');
                    document.querySelector('.blog-content-wrapper').classList.remove('hidden');
                    
                    // Populate blog post content
                    const blogPostContent = document.querySelector('.blog-post-content');
                    
                    blogPostContent.innerHTML = `
                        <div class="blog-post-header">
                            <div class="day-indicator">Day ${dayNumber}</div>
                            <div class="day-label">${day.label}</div>
                        </div>
                        <div class="blog-post-meta">
                            <span class="blog-date">${day.date}</span>
                            <span class="blog-category">${day.category}</span>
                        </div>
                        <h2 class="blog-post-title">${day.title}</h2>
                        <div class="blog-post-body">${day.content}</div>
                    `;
                    
                    // Scroll to top
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                } catch (error) {
                    console.error('Error showing day content:', error);
                    alert('Error loading blog content: ' + error.message);
                }
            }
            
            // Function to render the list of days in the manage tab
            async function renderDaysList() {
                try {
                    // Import Firebase functions
                    const { loadBlogsFromFirebase } = await import('./firebase-blog.js');
                    
                    // Get saved days from Firebase
                    const days = await loadBlogsFromFirebase();
                    
                    // Get list container
                    const daysList = document.getElementById('days-list');
                    const noDaysMessage = document.querySelector('.no-days-message');
                    
                    // Clear existing list
                    daysList.innerHTML = '';
                    
                    // Check if there are any days
                    const dayNumbers = Object.keys(days);
                    
                    if (dayNumbers.length === 0) {
                        noDaysMessage.classList.remove('hidden');
                        return;
                    } else {
                        noDaysMessage.classList.add('hidden');
                    }
                    
                    // Sort day numbers numerically
                    dayNumbers.sort((a, b) => parseInt(a) - parseInt(b));
                    
                    // Create list items
                    dayNumbers.forEach(dayNumber => {
                        const day = days[dayNumber];
                        
                        const listItem = document.createElement('div');
                        listItem.className = 'day-list-item';
                        
                        listItem.innerHTML = `
                            <div class="day-info">
                                <div class="day-number">Day ${dayNumber}</div>
                                <div class="day-title">${day.title}</div>
                            </div>
                            <div class="day-actions">
                                <button class="delete-day-btn" data-day="${dayNumber}">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        `;
                        
                        daysList.appendChild(listItem);
                    });
                    
                    // Add event listeners to delete buttons
                    document.querySelectorAll('.delete-day-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const dayNumber = this.getAttribute('data-day');
                            deleteDay(dayNumber);
                        });
                    });
                } catch (error) {
                    console.error('Error rendering days list:', error);
                    // Don't show alert here to prevent overwhelming the user with errors
                }
            }
            
            // Function to delete a day
            async function deleteDay(dayNumber) {
                // Confirm deletion
                if (!confirm(`Are you sure you want to delete Day ${dayNumber}?`)) {
                    return; // User cancelled
                }
                
                try {
                    // Import Firebase functions
                    const { loadBlogsFromFirebase, deleteBlogFromFirebase } = await import('./firebase-blog.js');
                    
                    // Get saved days from Firebase
                    const days = await loadBlogsFromFirebase();
                    
                    // Check if the day exists
                    if (!days[dayNumber]) {
                        alert('Day not found!');
                        return;
                    }
                    
                    // Show loading state
                    const calendarDay = document.querySelector(`.calendar-day[data-day="${dayNumber}"]`);
                    if (calendarDay) {
                        calendarDay.classList.add('deleting');
                    }
                    
                    // Get the document ID
                    const dayId = days[dayNumber].id;
                    
                    // Delete from Firebase
                    const success = await deleteBlogFromFirebase(dayId);
                    
                    if (success) {
                        // Refresh the days list
                        renderDaysList();
                        
                        // Refresh the calendar
                        await loadSavedDays();
                        
                        // Update empty state
                        checkAndToggleEmptyState();
                    } else {
                        alert('Error deleting blog day.');
                    }
                } catch (error) {
                    console.error('Error deleting day:', error);
                    alert('Error deleting blog day: ' + error.message);
                }
            }
            
            // Function to clear all days
            async function clearAllDays() {
                try {
                    // Import Firebase functions
                    const { loadBlogsFromFirebase, clearAllBlogsFromFirebase } = await import('./firebase-blog.js');
                    
                    // Get saved days from Firebase
                    const days = await loadBlogsFromFirebase();
                    const count = Object.keys(days).length;
                    
                    if (count === 0) {
                        alert('No blog days to clear.');
                        return;
                    }
                    
                    // Confirm deletion with specific count
                    if (!confirm(`Are you sure you want to delete ALL ${count} blog days? This cannot be undone!`)) {
                        return; // User cancelled
                    }
                    
                    // Extra security confirmation
                    const secondConfirm = prompt(`Type "DELETE ALL" to confirm that you want to permanently delete all ${count} blog days.`);
                    
                    if (secondConfirm !== "DELETE ALL") {
                        alert('Operation cancelled.');
                        return;
                    }
                    
                    // Show loading state
                    const clearButton = document.getElementById('clear-all-days');
                    const originalButtonText = clearButton.innerHTML;
                    clearButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Deleting...';
                    clearButton.disabled = true;
                    
                    // Clear from Firebase
                    const success = await clearAllBlogsFromFirebase();
                    
                    if (success) {
                        // Clear the calendar grid and update UI
                        document.getElementById('calendar-grid').innerHTML = '';
                        
                        // Refresh the days list
                        renderDaysList();
                        
                        // Reset the day number in form
                        document.getElementById('day-number').value = '1';
                        
                        // Show success message
                        alert('All blog days have been deleted.');
                        
                        // Update empty state
                        checkAndToggleEmptyState();
                    } else {
                        alert('Error deleting all blog days.');
                    }
                } catch (error) {
                    console.error('Error clearing all days:', error);
                    alert('Error deleting all blog days: ' + error.message);
                } finally {
                    // Restore button state
                    const clearButton = document.getElementById('clear-all-days');
                    clearButton.innerHTML = '<i class="fas fa-trash-alt"></i> Verwijder Alle Dagen';
                    clearButton.disabled = false;
                }
            }
            
            // Handle form submission to create a new day
            newDayForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const dayNumber = document.getElementById('day-number').value;
                const dayLabel = document.getElementById('day-label').value;
                const dayDate = document.getElementById('day-date').value;
                const dayCategory = document.getElementById('day-category').value;
                const dayTitle = document.getElementById('day-title').value;
                const dayContent = document.getElementById('day-content').value;
                
                // Show loading state
                const createBtn = document.getElementById('create-day-btn');
                const originalBtnText = createBtn.textContent;
                createBtn.textContent = 'Saving...';
                createBtn.disabled = true;
                
                try {
                    // Import Firebase functions
                    const { saveDayToFirebase } = await import('./firebase-blog.js');
                    
                    // Save to Firebase
                    const success = await saveDayToFirebase(dayNumber, dayLabel, dayDate, dayCategory, dayTitle, dayContent);
                    
                    if (success) {
                        // Create the calendar day
                        const calendarGrid = document.getElementById('calendar-grid');
                        const dayElement = document.createElement('div');
                        dayElement.className = 'calendar-day';
                        dayElement.setAttribute('data-day', dayNumber);
                        
                        dayElement.innerHTML = `
                            <span class="day-number">Day ${dayNumber}</span>
                            <span class="day-label">${dayLabel}</span>
                        `;
                        
                        calendarGrid.appendChild(dayElement);
                        
                        // Add click event
                        dayElement.addEventListener('click', () => {
                            showDayContent(dayNumber);
                        });
                        
                        // Reset form
                        document.getElementById('new-day-form').reset();
                        setNextDayNumber();
                        
                        // Update empty state
                        checkAndToggleEmptyState();
                        
                        // Close admin panel
                        adminPanel.classList.add('hidden');
                        
                        // Show success message
                        alert('Day ' + dayNumber + ' created successfully!');
                    } else {
                        alert('Error saving blog day to Firebase.');
                    }
                } catch (error) {
                    console.error('Error saving blog day:', error);
                    alert('Error saving blog day: ' + error.message);
                } finally {
                    // Restore button state
                    createBtn.textContent = originalBtnText;
                    createBtn.disabled = false;
                }
            });
            
            // Function to save day data (previously using localStorage, now using Firebase)
            function saveDayToLocalStorage(number, label, date, category, title, content) {
                // This function is kept for backward compatibility
                // The actual saving is now done in the form submission handler using Firebase
                console.log('Using Firebase instead of localStorage');
            }
            
            // Function to check if there are any days and toggle empty state
            function checkAndToggleEmptyState() {
                const calendarGrid = document.getElementById('calendar-grid');
                const emptyState = document.getElementById('empty-calendar-state');
                const savedDays = document.querySelectorAll('.calendar-day').length;
                
                if (savedDays === 0) {
                    // No days, show empty state
                    if (emptyState) emptyState.style.display = 'block';
                    if (calendarGrid) calendarGrid.style.display = 'none';
                } else {
                    // Days exist, hide empty state
                    if (emptyState) emptyState.style.display = 'none';
                    if (calendarGrid) calendarGrid.style.display = 'grid';
                }
            }
            
            // Function to load saved days from Firebase
            async function loadSavedDays() {
                try {
                    // Import Firebase functions
                    const { loadBlogsFromFirebase } = await import('./firebase-blog.js');
                    
                    // Get saved days from Firebase
                    const days = await loadBlogsFromFirebase();
                    
                    // Check if there are any days
                    if (Object.keys(days).length === 0) {
                        return; // No days to load
                    }
                    
                    // Get the calendar grid
                    const calendarGrid = document.getElementById('calendar-grid');
                    
                    // Clear existing days first
                    calendarGrid.innerHTML = '';
                    
                    // Sort the days by number
                    const sortedDayNumbers = Object.keys(days).sort((a, b) => parseInt(a) - parseInt(b));
                    
                    // Create elements for each day
                    sortedDayNumbers.forEach(dayNumber => {
                        const day = days[dayNumber];
                        
                        const dayElement = document.createElement('div');
                        dayElement.className = 'calendar-day';
                        dayElement.setAttribute('data-day', dayNumber);
                        dayElement.setAttribute('data-id', day.id); // Store Firebase document ID
                        
                        dayElement.innerHTML = `
                            <span class="day-number">Day ${dayNumber}</span>
                            <span class="day-label">${day.label}</span>
                        `;
                        
                        calendarGrid.appendChild(dayElement);
                        
                        // Add click event
                        dayElement.addEventListener('click', () => {
                            showDayContent(dayNumber);
                        });
                    });
                    
                    // Update empty state
                    checkAndToggleEmptyState();
                    
                    // Set next day number for form
                    setNextDayNumber();
                } catch (error) {
                    console.error('Error loading saved days:', error);
                    alert('Error loading blog posts: ' + error.message);
                }
            }
            
            // Connect clear all days button to its function
            const clearAllDaysButton = document.getElementById('clear-all-days');
            if (clearAllDaysButton) {
                clearAllDaysButton.addEventListener('click', clearAllDays);
            }
            
            // Load any saved days when the page loads
            document.addEventListener('DOMContentLoaded', async () => {
                try {
                    await loadSavedDays();
                    // Initial check for empty state
                    checkAndToggleEmptyState();
                    
                    // Add event listener for 'clear all days' button
                    const clearAllDaysButton = document.getElementById('clear-all-days');
                    if (clearAllDaysButton) {
                        clearAllDaysButton.addEventListener('click', clearAllDays);
                    }
                } catch (error) {
                    console.error('Error initializing blog:', error);
                }
            });
        }
    });
</script>
</body>
</html>
